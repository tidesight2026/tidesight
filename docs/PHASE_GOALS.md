# أهداف مراحل التطوير - AquaERP

> هذا الملف يحدد أهداف واضحة لكل مرحلة تطوير بناءً على تحليل الفجوات والمقارنة مع AquaManager و WiseFish.

---

## المرحلة 2 – تقوية الوظائف الجوهرية (Core Features)

**المدة المتوقعة:** 3–6 أسابيع

### الهدف العام
تعزيز نموذج إدارة المزرعة وإضافة طبقة تتبع Traceability قوية لربط جميع العمليات من الدفعة حتى البيع.

---

### 2.1 تحسين نموذج إدارة المزرعة (Biological & Daily Operations)

#### الأهداف المحددة:

1. **مراجعة وتحديث نماذج Django**
   - ✅ `Batch` - موجود ويحتاج تحسينات بسيطة
   - ✅ `Pond` - موجود
   - ✅ `FeedingLog` - موجود ويحتاج تحسينات بسيطة
   - ✅ `MortalityLog` - موجود

2. **التأكد من وجود الحقول الأساسية**
   - ✅ جميع الحقول الأساسية موجودة في `Batch`
   - ✅ جميع الحقول الأساسية موجودة في `FeedingLog`
   - ✅ جميع الحقول الأساسية موجودة في `MortalityLog`

3. **إضافة/تحسين الدوال الحسابية الأساسية**
   - ⚠️ **معدل النمو (Weight Gain)** - موجود جزئياً، يحتاج تحسين
     - الهدف: حساب معدل النمو اليومي/الأسبوعي/الشهري
     - الصيغة: `(current_weight - previous_weight) / days`
   - ⚠️ **معامل تحويل العلف (FCR)** - موجود جزئياً، يحتاج تحسين
     - الهدف: حساب FCR بدقة لكل دفعة
     - الصيغة: `total_feed_consumed / total_weight_gain`
   - ✅ **نسبة النفوق** - موجود بالفعل
     - الصيغة: `(initial_count - current_count) / initial_count * 100`

4. **إضافة Unit Tests**
   - ⚠️ Unit Tests للحسابات (يحتاج تحسين)
   - الهدف: تغطية 80%+ من الدوال الحسابية

---

### 2.2 بناء طبقة التتبع (Traceability Layer)

#### الأهداف المحددة:

1. **ربط بيانات الحصاد والمبيعات بالدفعات الإنتاجية**
   - ✅ `Harvest.batch` - موجود (ForeignKey إلى `Batch`)
   - ✅ `SalesOrderLine.harvest` - موجود (ForeignKey إلى `Harvest`)
   - ⚠️ **تحسين الربط** - يحتاج تحسين
     - إضافة حقل `batch` مباشر في `SalesOrderLine` (اختياري)
     - إضافة methods للوصول السريع للدفعة من الفاتورة

2. **تصميم/إضافة نموذج `TraceabilityRecord` (إن لزم)**
   - ⚠️ **تقييم الحاجة** - يحتاج تقييم
     - إذا كان الربط الحالي كافٍ → لا حاجة لنموذج منفصل
     - إذا احتجنا تتبع إضافي → إنشاء `TraceabilityRecord`
   - الحقول المقترحة (إن لزم):
     - `batch` - الدفعة
     - `harvest` - الحصاد
     - `sales_order` - طلب البيع
     - `invoice` - الفاتورة
     - `customer` - العميل
     - `dates` - التواريخ الرئيسية

3. **بناء Endpoints في `api/`**
   - ⚠️ `GET /api/traceability/by-invoice/{id}/` - يحتاج إنشاء
     - الهدف: استرجاع سلسلة التتبع من الفاتورة إلى الدفعة
     - الإرجاع: معلومات الدفعة، الحصاد، طلب البيع، الفاتورة
   - ⚠️ `GET /api/traceability/by-batch/{id}/` - يحتاج إنشاء
     - الهدف: استرجاع جميع المبيعات المرتبطة بالدفعة
     - الإرجاع: قائمة بالحصاد، طلبات البيع، الفواتير

4. **توثيق APIs**
   - ⚠️ إنشاء ملف `API_DOCS.md` - يحتاج إنشاء
     - توثيق جميع Traceability APIs
     - أمثلة على الاستخدام
     - صيغ البيانات

---

## المرحلة 3 – تحسين واجهة الاستخدام والتقارير (UX & Reporting)

**المدة المتوقعة:** 3–5 أسابيع

### الهدف العام
تحسين تجربة المستخدم وإضافة لوحات متابعة وتقارير Traceability للمستخدم النهائي.

---

### 3.1 لوحات متابعة (Dashboards) تشغيلية للمزرعة

#### الأهداف المحددة:

1. **إنشاء API Dashboard في Django**
   - ⚠️ `GET /api/dashboard/farm-overview/` - موجود جزئياً، يحتاج تحسين
     - الهدف: إحصائيات عامة للمزرعة
     - البيانات المطلوبة:
       - ✅ عدد الأحواض النشطة
       - ✅ عدد الدفعات النشطة
       - ⚠️ إجمالي الكتلة الحية التقديرية (يحتاج تحسين)
       - ⚠️ استهلاك العلف خلال فترة محددة (أسبوع/شهر) - يحتاج إضافة
       - ⚠️ إجمالي النفوق خلال فترة محددة - يحتاج إضافة
   - ⚠️ `GET /api/dashboard/batch-performance/` - موجود جزئياً، يحتاج تحسين
     - الهدف: أداء كل دفعة
     - البيانات المطلوبة:
       - ⚠️ لكل Batch: FCR (يحتاج تحسين)
       - ⚠️ لكل Batch: متوسط الوزن (يحتاج تحسين)
       - ✅ لكل Batch: نسبة النفوق (موجود)
       - ⚠️ لكل Batch: معدل النمو (يحتاج إضافة)
       - ⚠️ لكل Batch: التكلفة التراكمية (يحتاج إضافة)

2. **إنشاء صفحات React للـDashboard**
   - ⚠️ `FarmOverviewDashboard` - موجود جزئياً، يحتاج تحسين
     - الهدف: عرض مؤشرات المزرعة العامة
     - المكونات:
       - Widgets للإحصائيات
       - رسوم بيانية للاتجاهات
       - قائمة بالدفعات النشطة
   - ⚠️ `BatchPerformanceDashboard` - موجود جزئياً، يحتاج تحسين
     - الهدف: عرض أداء الدفعات
     - المكونات:
       - جدول بأداء كل دفعة
       - رسوم بيانية للمقارنة
       - فلاتر حسب الحالة/النوع

3. **استخدام مكتبة رسوم**
   - ✅ Recharts موجودة بالفعل
   - ⚠️ إضافة رسوم بيانية جديدة - يحتاج تحسين
     - رسم FCR عبر الزمن
     - رسم معدل النمو
     - رسم استهلاك العلف

---

### 3.2 تقارير Traceability للمستخدم النهائي

#### الأهداف المحددة:

1. **صفحة React لبحث التتبع**
   - ❌ `TraceabilitySearchPage` - يحتاج إنشاء
     - الهدف: صفحة بحث للتتبع
     - المكونات:
       - ❌ بحث برقم الفاتورة (Invoice No) - يحتاج إنشاء
       - ❌ بحث برقم الدفعة (Batch ID) - يحتاج إنشاء
       - ❌ بحث برقم الحصاد (Harvest ID) - يحتاج إنشاء

2. **عرض النتائج**
   - ❌ `TraceabilityResultView` - يحتاج إنشاء
     - الهدف: عرض سلسلة التتبع
     - من الفاتورة → الدفعة/الأحواض:
       - ❌ معلومات الفاتورة - يحتاج إنشاء
       - ❌ معلومات طلب البيع - يحتاج إنشاء
       - ❌ معلومات الحصاد - يحتاج إنشاء
       - ❌ معلومات الدفعة - يحتاج إنشاء
       - ❌ معلومات الحوض - يحتاج إنشاء
       - ❌ تواريخ التغذية الرئيسية - يحتاج إنشاء
       - ❌ تواريخ النفوق الرئيسية - يحتاج إنشاء
     - من الدفعة → كل عمليات الحصاد والمبيعات:
       - ❌ معلومات الدفعة - يحتاج إنشاء
       - ❌ قائمة الحصاد المرتبطة - يحتاج إنشاء
       - ❌ قائمة طلبات البيع المرتبطة - يحتاج إنشاء
       - ❌ قائمة الفواتير المرتبطة - يحتاج إنشاء

---

### 3.3 تحسين تجربة المستخدم العامة (General UX)

#### الأهداف المحددة:

1. **مراجعة شاشات الإدخال الرئيسية**
   - ⚠️ إنشاء دفعة - موجود، يحتاج تحسين
     - تقليل عدد الخطوات
     - تحسين وضوح الحقول
     - تحسين الرسائل
   - ⚠️ تسجيل تغذية - موجود، يحتاج تحسين
     - تحسين وضوح الحقول
     - تحسين الرسائل
   - ⚠️ تسجيل نفوق - موجود، يحتاج تحسين
     - تحسين وضوح الحقول
     - تحسين الرسائل
   - ⚠️ تسجيل حصاد - موجود، يحتاج تحسين
     - تحسين وضوح الحقول
     - تحسين الرسائل
   - ⚠️ إنشاء طلب بيع - موجود، يحتاج تحسين
     - تحسين وضوح الحقول
     - تحسين الرسائل

2. **إضافة تحسينات سريعة (Quick Wins)**
   - ⚠️ Auto-complete للقوائم المتكررة - موجود جزئياً، يحتاج تحسين
     - أنواع الأسماك
     - أنواع الأعلاف
     - العملاء
   - ⚠️ تلوين/وسوم (Tags) لحالة الدفعات - موجود جزئياً، يحتاج تحسين
     - نشطة (أخضر)
     - قريبة من الحصاد (أصفر)
     - منتهية (رمادي)

---

## المرحلة 4 – التكاملات، الجودة والأمن (Integrations, Quality & Security)

**المدة المتوقعة:** 4–8 أسابيع (يمكن التنفيذ بالتوازي)

### الهدف العام
تحسين الأداء وجودة البيانات، إضافة تكاملات محتملة، وتعزيز الأمن والصلاحيات.

---

### 4.1 تحسين الأداء وجودة البيانات

#### الأهداف المحددة:

1. **مراجعة استخدام `performance/query_optimization.py`**
   - ✅ التأكد من وجود فهارس (Indexes) - موجود
   - ⚠️ مراجعة الفهارس الموجودة - يحتاج مراجعة
     - `FeedingLog` - موجود
     - `MortalityLog` - موجود
     - `SalesOrderLine` - يحتاج فحص
     - `TraceabilityRecord` (إن وُجد) - يحتاج فحص

2. **إضافة اختبارات (Unit/Integration Tests)**
   - ⚠️ تسجيل تغذية - موجود جزئياً، يحتاج تحسين
   - ⚠️ تسجيل نفوق - موجود جزئياً، يحتاج تحسين
   - ⚠️ تسجيل حصاد - موجود جزئياً، يحتاج تحسين
   - ⚠️ إنشاء فاتورة مرتبطة بدفعة - موجود جزئياً، يحتاج تحسين
   - ❌ استرجاع بيانات Traceability - يحتاج إنشاء

3. **مراجعة سجلات الأخطاء (Logging)**
   - ⚠️ إضافة رسائل واضحة في نقاط الفشل المعروفة - يحتاج تحسين
   - ⚠️ تحسين مستويات Logging - يحتاج تحسين

---

### 4.2 التكاملات المحتملة

#### الأهداف المحددة:

1. **تكامل محاسبي أعمق داخل `accounting`**
   - ✅ كل حدث ينعكس في القيود المحاسبية - موجود
   - ⚠️ إضافة تقارير مالية تربط بين الأداء الحيوي والمالي - يحتاج تحسين
     - تقرير: التكلفة الحيوية مقابل الإيرادات
     - تقرير: الربحية لكل دفعة
     - تقرير: FCR مقابل التكلفة

2. **التحضير لتكامل IoT مستقبلي**
   - ❌ تصميم نموذج `SensorReading` - يحتاج إنشاء
     - الحقول المقترحة:
       - `pond` - الحوض
       - `sensor_type` - نوع المستشعر (temperature/oxygen/pH)
       - `reading_value` - قيمة القراءة
       - `reading_date` - تاريخ القراءة
       - `is_alert` - هل هناك تنبيه؟
   - ❌ إضافة Endpoints مبدئية - يحتاج إنشاء
     - `POST /api/iot/sensor-readings/` - استقبال قراءات
     - `GET /api/iot/sensor-readings/` - عرض القراءات

---

### 4.3 الأمن والصلاحيات

#### الأهداف المحددة:

1. **مراجعة صلاحيات المستخدمين**
   - ✅ تعريف أدوار (Roles) واضحة - موجود
     - admin
     - farm_manager
     - operator
     - accountant
     - sales_manager
   - ⚠️ ضبط الوصول إلى الشاشات/الـAPIs حسب الأدوار - موجود جزئياً، يحتاج تحسين
     - مراجعة جميع الـ APIs
     - مراجعة جميع الصفحات

2. **مراجعة إعدادات الأمن في Django/Frontend**
   - ✅ الحماية من CSRF/XSS - موجود
   - ✅ إدارة الجلسات (Sessions) - موجود
   - ⚠️ مراجعة إعدادات الأمن - يحتاج مراجعة
     - Security Headers
     - Rate Limiting
     - Token Refresh

---

## ملخص الأهداف حسب الأولوية

### أولوية عالية (يجب إكمالها في المرحلة 2)
1. ✅ تحسين الدوال الحسابية (FCR، معدل النمو)
2. ⚠️ بناء APIs للتتبع (Traceability)
3. ⚠️ تحسين Dashboard APIs

### أولوية متوسطة (يجب إكمالها في المرحلة 3)
1. ⚠️ إنشاء صفحات React للـDashboard
2. ❌ صفحة بحث التتبع
3. ⚠️ تحسين UX للشاشات الرئيسية

### أولوية منخفضة (يمكن إكمالها في المرحلة 4)
1. ⚠️ تحسين الاختبارات
2. ❌ التحضير لـ IoT
3. ⚠️ مراجعة الأمن والصلاحيات

---

**تاريخ الإنشاء:** 2024  
**آخر تحديث:** 2024

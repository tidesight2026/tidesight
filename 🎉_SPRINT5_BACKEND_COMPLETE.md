# ๐ Sprint 5 - Backend ููุชูู!

**ุงูุชุงุฑูุฎ:** ุฏูุณูุจุฑ 2025  
**ุงูุญุงูุฉ:** โ **Backend 100% ููุชูู**

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### Backend Models:

1. โ **Harvest Model**:
   - ุฑุจุท ูุน Batch
   - ูููุฉ ูุนุฏุฏ ุงูุญุตุงุฏ
   - ุญุณุงุจ ุงูุชูููุฉ ูุงููููุฉ ุงูุนุงุฏูุฉ
   - ุญุงูุงุช ุงูุญุตุงุฏ (pending, in_progress, completed, cancelled)

2. โ **SalesOrder Model**:
   - ุจูุงูุงุช ุงูุนููู (ุงูุงุณูุ ุงููุงุชูุ ุงูุนููุงู)
   - ุญุณุงุจ ุงูุถุฑูุจุฉ ูุงูุฅุฌูุงูู ุชููุงุฆูุงู
   - ุญุงูุงุช ุงูุทูุจ (draft, confirmed, invoiced, delivered, cancelled)

3. โ **SalesOrderLine Model**:
   - ุฑุจุท ูุน Harvest
   - ูููุฉ ูุณุนุฑ ุงูุจูุน
   - ุญุณุงุจ ุงููุฌููุน ุชููุงุฆูุงู

4. โ **Invoice Model**:
   - ุฑุจุท ูุน SalesOrder (OneToOne)
   - ุญููู ZATCA (QR Code, UUID, Signed XML)
   - ุญุงูุงุช ุงููุงุชูุฑุฉ (draft, issued, paid, cancelled)

### Signals:
- โ **Harvest Signal** - ููุฏ ุชููุงุฆู ุนูุฏ ุงูุญุตุงุฏ:
  ```
  ูู: ุญ/ ูุฎุฒูู ููุชุฌ ุชุงู (ูุฏูู)
  ุฅูู: ุญ/ ุงูุฃุตูู ุงูุจููููุฌูุฉ (ุฏุงุฆู)
  ```

- โ **Invoice Signal** - ููุฏ ุชููุงุฆู ุนูุฏ ุฅุตุฏุงุฑ ุงููุงุชูุฑุฉ:
  ```
  ูู: ุญ/ ุงูุนููุงุก (ูุฏูู)
  ุฅูู: ุญ/ ุฅูุฑุงุฏุงุช ุงููุจูุนุงุช (ุฏุงุฆู)
  ุฅูู: ุญ/ ุงูุถุฑูุจุฉ ุงููุณุชุญูุฉ (ุฏุงุฆู)
  ูู: ุญ/ ุชูููุฉ ุงูุจุถุงุนุฉ ุงููุจุงุนุฉ (ูุฏูู)
  ุฅูู: ุญ/ ูุฎุฒูู ููุชุฌ ุชุงู (ุฏุงุฆู)
  ```

### API Endpoints (6 endpoints):
- โ `GET /api/sales/harvests` - ูุงุฆูุฉ ุงูุญุตุงุฏ (ูุน Filter by batch_id, status)
- โ `POST /api/sales/harvests` - ุฅูุดุงุก ุญุตุงุฏ ุฌุฏูุฏ
- โ `GET /api/sales/sales-orders` - ูุงุฆูุฉ ุทูุจุงุช ุงูุจูุน (ูุน Filter by status)
- โ `POST /api/sales/sales-orders` - ุฅูุดุงุก ุทูุจ ุจูุน ุฌุฏูุฏ
- โ `GET /api/sales/invoices` - ูุงุฆูุฉ ุงูููุงุชูุฑ (ูุน Filter by status)
- โ `POST /api/sales/invoices` - ุฅูุดุงุก ูุงุชูุฑุฉ ูู ุทูุจ ุจูุน

---

## ๐ ุงูููุฒุงุช

### ุงูุญุตุงุฏ:
- โ ุญุณุงุจ ุงูุชูููุฉ ุงูุชุฑุงูููุฉ ุชููุงุฆูุงู (ูู ุงูุชูููุฉ ุงูุฃูููุฉ + ุชูููุฉ ุงูุนูู)
- โ ุญุณุงุจ ุงููููุฉ ุงูุนุงุฏูุฉ
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูุฏูุนุฉ ุชููุงุฆูุงู
- โ ููุฏ ูุญุงุณุจู ุชููุงุฆู (ุชุญููู ูู ุฃุตู ุจููููุฌู ุฅูู ูุฎุฒูู ุชุงู)

### ุงููุจูุนุงุช:
- โ ุฅูุดุงุก ุทูุจุงุช ุจูุน ูู ุงูุญุตุงุฏ
- โ ุญุณุงุจ ุงูุถุฑูุจุฉ ุชููุงุฆูุงู (15% ุงูุชุฑุงุถู)
- โ ุฅุตุฏุงุฑ ููุงุชูุฑ ูู ุทูุจุงุช ุงูุจูุน
- โ ููุฏ ูุญุงุณุจู ุชููุงุฆู (ุฅูุฑุงุฏุงุช + ุชูููุฉ ุงูุจุถุงุนุฉ ุงููุจุงุนุฉ)

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. โณ **ZATCA Integration**:
   - QR Code Generation (TLV Format Base64)
   - XML Generation (UBL 2.1)
   - ECDSA Signing
   - ZATCA API Integration

2. โณ **Frontend**:
   - ุตูุญุฉ ุงูุญุตุงุฏ (CRUD)
   - ุตูุญุฉ ุงููุจูุนุงุช (Create Order, View Orders)
   - ุตูุญุฉ ุงูููุงุชูุฑ (View Invoices, Generate PDF)
   - PDF Export (ReportLab ุฃู WeasyPrint)

---

**โจ Backend ูููุจูุนุงุช ุฌุงูุฒ! ุฌุงูุฒ ูููุชุงุจุนุฉ ุจู Frontend ุฃู ZATCA Integration!** โจ

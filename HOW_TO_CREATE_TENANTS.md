# ููููุฉ ุฅูุดุงุก Tenants (ุงูุนููุงุก) ูู AquaERP

## โ๏ธ ูุดููุฉ ุดุงุฆุนุฉ

ุนูุฏ ูุญุงููุฉ ุฅูุดุงุก tenant ุฌุฏูุฏ ูู ุฏุงุฎู tenant schema (ูุซู `farm1.localhost:8000`)ุ ุณุชุญุตู ุนูู ุงูุฎุทุฃ ุงูุชุงูู:

```
Can't create tenant outside the public schema. Current schema is farm1.
```

## โ ุงูุญู

ูุฌุจ ุงููุตูู ุฅูู Django Admin ูู **public schema** ูุฅูุดุงุก tenants ุฌุฏูุฏุฉ.

### ุทุฑููุฉ ุงููุตูู ุฅูู Public Schema

ูู `django-tenants`ุ public schema ูู ุงููุฎุทุท ุงูุงูุชุฑุงุถู ุงูุฐู ูุง ูุญุชูู ุนูู subdomain.

#### 1. ุงููุตูู ุนุจุฑ localhost (ุจุฏูู subdomain)

ุงูุชุญ ุงููุชุตูุญ ูุงูุชูู ุฅูู:
```
http://localhost:8000/admin/
```

**ุฃู**

```
http://127.0.0.1:8000/admin/
```

#### 2. ุชุณุฌูู ุงูุฏุฎูู

ุงุณุชุฎุฏู ููุณ ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู:
- **Username:** `SmartFarm`
- **Password:** `admin123`

> **ููุงุญุธุฉ:** ูุฏ ุชุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุณุชุฎุฏู superuser ูู public schema ุฅุฐุง ูู ููู ููุฌูุฏุงู.

---

## ๐ ุฎุทูุงุช ุฅูุดุงุก Tenant ุฌุฏูุฏ

### 1. ุงููุตูู ุฅูู Public Schema Admin

ุงูุชุญ: `http://localhost:8000/admin/`

### 2. ุงูุงูุชูุงู ุฅูู ุฅุฏุงุฑุฉ ุงูุนููุงุก

ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉุ ุงุถุบุท ุนูู **"ุฅุฏุงุฑุฉ ุงูุนููุงุก"** โ **"ุงูุนููุงุก"**

### 3. ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ

ุงุถุบุท ุนูู **"ุฅุถุงูุฉ ุนููู"** (Add Client)

### 4. ููุก ุงูุจูุงูุงุช

- **ุงุณู ุงูุดุฑูุฉ:** ุงุณู ุงูุดุฑูุฉ
- **ุฑูู ุงูุณุฌู ุงูุชุฌุงุฑู:** (ุงุฎุชูุงุฑู)
- **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:** ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- **ุงููุงุชู:** (ุงุฎุชูุงุฑู)
- **ููุน ุงูุงุดุชุฑุงู:** ุงุฎุชุฑ ูู ุงููุงุฆูุฉ
- **Schema Name:** ุณูุชู ุฅูุดุงุคู ุชููุงุฆูุงู (ุฃู ููููู ุชุญุฏูุฏู)
- **ุญุงูุฉ ุงููุดุงุท:** ูุดุท/ุบูุฑ ูุดุท

### 5. ุญูุธ

ุงุถุบุท **"ุงุญูุธ"** (Save)

### 6. ุฅุถุงูุฉ Domain

ุจุนุฏ ุฅูุดุงุก Tenantุ ูุฌุจ ุฅุถุงูุฉ Domain ูู:

1. ูู ููุณ ุตูุญุฉ Adminุ ุงูุชูู ุฅูู **"ุฅุฏุงุฑุฉ ุงูุนููุงุก"** โ **"ุงููุทุงูุงุช"** (Domains)
2. ุงุถุบุท **"ุฅุถุงูุฉ ูุทุงู"** (Add Domain)
3. ุงุฎุชุฑ **Tenant** ูู ุงููุงุฆูุฉ
4. ุฃุฏุฎู **Domain** (ูุซู: `farm2.localhost`)
5. ุญุฏุฏ **Is Primary** ุฅุฐุง ูุงู ุงููุทุงู ุงูุฃุณุงุณู
6. ุงุญูุธ

### 7. ุฅุถุงูุฉ Domain ุฅูู hosts file

ุฃุถู ุงูุณุทุฑ ุงูุชุงูู ุฅูู ููู `hosts`:

```
127.0.0.1    farm2.localhost
```

### 8. ุชุดุบูู Migrations ููู Tenant ุงูุฌุฏูุฏ

```bash
docker-compose exec web python manage.py migrate_schemas --tenant
```

ุฃู ููู tenant ูุญุฏุฏ:

```bash
docker-compose exec web python manage.py migrate_schemas --tenant --schema_name farm2
```

---

## ๐ง ุฅูุดุงุก ูุณุชุฎุฏู Admin ูู Public Schema

ุฅุฐุง ูู ููู ูุฏูู ูุณุชุฎุฏู admin ูู public schema:

```bash
docker-compose exec web python manage.py createsuperuser --schema_name public
```

ุฃู ุงุณุชุฎุฏู ุงูุณูุฑูุจุช ุงููุฎุตุต:

```bash
docker-compose exec web python create_admin_user.py
```

(ุนุฏูู `SCHEMA_NAME = 'public'` ูู ุงูุณูุฑูุจุช)

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **Public Schema ููุท:** ูููู ุฅูุดุงุก tenants ููุท ูู public schema
2. **Domains ูุทููุจุฉ:** ูู tenant ูุญุชุงุฌ domain ูุงุญุฏ ุนูู ุงูุฃูู
3. **Migrations:** ูุฌุจ ุชุดุบูู migrations ููู tenant ุฌุฏูุฏ
4. **Hosts File:** ูุฌุจ ุฅุถุงูุฉ domain ุฅูู ููู hosts ูููุตูู ุฅููู

---

## ๐จ ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ูุญููููุง

### ุฎุทุฃ: "Can't create tenant outside the public schema"

**ุงูุณุจุจ:** ุชุญุงูู ุฅูุดุงุก tenant ูู ุฏุงุฎู tenant schema

**ุงูุญู:** ุงุณุชุฎุฏู `http://localhost:8000/admin/` ุจุฏูุงู ูู `http://farm1.localhost:8000/admin/`

### ุฎุทุฃ: "Domain already exists"

**ุงูุณุจุจ:** Domain ูุณุชุฎุฏู ุจุงููุนู

**ุงูุญู:** ุงุณุชุฎุฏู domain ูุฎุชูู ุฃู ุงุญุฐู domain ุงููุฏูู

### ุฎุทุฃ: "Schema already exists"

**ุงูุณุจุจ:** schema_name ูุณุชุฎุฏู ุจุงููุนู

**ุงูุญู:** ุงุณุชุฎุฏู schema_name ูุฎุชูู

---

## ๐ ุฑูุงุจุท ูููุฏุฉ

- **Public Schema Admin:** http://localhost:8000/admin/
- **Tenant Admin (farm1):** http://farm1.localhost:8000/admin/
- **API Docs:** http://farm1.localhost:8000/api/docs

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-12-11
